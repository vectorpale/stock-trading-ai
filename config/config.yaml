# ============================================================
# 股票交易策略助手 - 主配置文件
# Stock Trading Strategy Assistant - Main Configuration
# ============================================================

# --- 市场与标的 ---
market:
  # 美股标的（示例：科技龙头 + ETF）
  us_stocks:
    - AAPL   # 苹果
    - MSFT   # 微软
    - NVDA   # 英伟达
    - GOOGL  # 谷歌
    - META   # Meta
    - AMZN   # 亚马逊
    - TSLA   # 特斯拉
    - SPY    # 标普500 ETF
    - QQQ    # 纳斯达克100 ETF

  # 港股标的（示例：蓝筹 + 科技）
  hk_stocks:
    - "0700.HK"   # 腾讯
    - "9988.HK"   # 阿里巴巴
    - "3690.HK"   # 美团
    - "9618.HK"   # 京东
    - "1810.HK"   # 小米
    - "2318.HK"   # 中国平安

# --- 数据设置 ---
data:
  lookback_days: 365          # 历史数据回溯天数
  signal_interval: "1d"       # 信号频率: 1d=每日, 30min=半日
  cache_dir: "data/cache"     # 本地数据缓存目录
  memory_dir: "data/memory"   # 辩论历史记忆存储目录（FinMem 分层记忆）

# --- 富途费率结构（Futu Fee Structure）---
fees:
  us:
    commission_per_share: 0.0049   # USD/股，平台佣金
    min_commission: 0.99           # USD，最低佣金
    platform_fee_per_share: 0.0049 # USD/股，平台使用费
    min_platform_fee: 0.99         # USD，最低平台费
    sec_fee_rate: 0.0000278        # 卖出时，SEC监管费率（按成交额）
    finra_taf_per_share: 0.000145  # 卖出时，FINRA TAF
    finra_taf_max: 7.27            # FINRA TAF 上限
    settlement_days: 2             # T+2 结算

  hk:
    commission_rate: 0.0003        # 佣金率 0.03%
    min_commission_hkd: 3.0        # 最低佣金 HKD
    platform_fee_rate: 0.0003      # 平台费率 0.03%
    min_platform_fee_hkd: 3.0      # 最低平台费 HKD
    stamp_duty_rate: 0.001         # 印花税 0.1%（买卖双方均收）
    transaction_levy_rate: 0.000027 # 证监会交易征费
    trading_fee_rate: 0.0000565    # 联交所交易费
    settlement_days: 2             # T+2 结算

# --- 风险管理 ---
risk:
  max_position_size: 0.12         # 单只股票最大仓位（占总资金）—— CIO 受此约束
  max_total_positions: 10         # 最大持仓数量（集中持仓，建议不超过10）
  min_cio_confidence: 65          # CIO 最低置信度：低于此值的 BUY 降级为 WATCH
  stop_loss_pct: 0.07             # 止损线（CIO 未给出时使用此默认值）
  take_profit_pct: 0.20           # 止盈线（CIO 未给出时使用此默认值）
  max_drawdown_halt: 0.15         # 组合回撤超过15%暂停交易

# --- 策略权重（多策略融合）---
strategy_weights:
  momentum: 0.35          # 动量策略权重
  mean_reversion: 0.25    # 均值回归策略权重
  multi_factor: 0.40      # 多因子策略权重

# --- 回测参数 ---
backtest:
  start_date: "2022-01-01"
  end_date: "2024-12-31"
  initial_capital: 100000         # 初始资金（USD 或 HKD）
  rebalance_frequency: "weekly"   # 再平衡频率

# --- AI / LLM 设置 ---
ai:
  enabled: true

  # ── 分角色模型配置（按任务复杂度选择模型，平衡质量与成本）──────────────
  #
  # 任务分级：
  #   高复杂度（CIO 裁决、深度辩论）→ Opus（最强推理）
  #   中复杂度（各分析师初始分析、辩论轮）→ Sonnet（性价比高）
  #   低复杂度（新闻情绪摘要、格式化）→ Haiku（最快最便宜）
  #
  # 模型 ID 参考（2025）：
  #   claude-opus-4-6       最强推理，适合 CIO 最终裁决
  #   claude-sonnet-4-6     高性价比，适合分析师分析
  #   claude-haiku-4-5-20251001  最快最便宜，适合情绪摘要
  #
  model_cio: "claude-opus-4-6"           # CIO 最终裁决（Phase 4）
  model_analyst: "claude-sonnet-4-6"     # 各分析师分析（Phase 1/2/3）
  model_sentiment: "claude-haiku-4-5-20251001"  # 新闻情绪摘要（低复杂度）

  # 兼容旧配置：若未指定上述分角色模型，则统一使用此模型
  model: "claude-sonnet-4-6"

  # AI 模式选择:
  #   debate : 两阶段架构，CIO 全权裁决（量化初筛 + 深度辩论）[推荐]
  #   simple : 单智能体技术分析（速度快，费用低）
  mode: "debate"

  sentiment_weight: 0.20          # simple 模式下 AI 权重（debate 模式不使用）
  news_lookback_days: 7           # 分析最近N天新闻

  # 辩论引擎参数（mode=debate 时生效）
  debate_rounds: 1                # 辩论轮数（0=仅初始+CIO，1=标准，2+=深度）
  convergence_threshold: 0.85     # 收敛阈值：超过则提前停止辩论
  max_debate_rounds: 3            # 最大辩论轮数上限
  quant_prefilter_threshold: 15   # 量化初筛阈值（低于此分的标的跳过辩论）
